<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <title>riak-js | Riak Javascript library</title>
    <link href=' http://fonts.googleapis.com/css?family=Molengo' rel='stylesheet' type='text/css' />
    <link href=' http://fonts.googleapis.com/css?family=Yanone+Kaffeesatz' rel='stylesheet' type='text/css' />
    <style type="text/css" media="screen">
      
      body { background: #D9CBA3; font-size: 16pt; }
      
      #container { width: 890px; color: white; margin: 20px auto; padding: 30px;
        -moz-box-shadow:    0 10px 14px rgba(0, 0, 0, 0.8);
        -webkit-box-shadow: 0 10px 14px rgba(0, 0, 0, 0.8);
        background-color: #333;
        font-family: 'Molengo', arial, serif;
        line-height: 1.4;
      }
      
      h1, h2, h3, h4 { font-family: 'Yanone Kaffeesatz', arial, serif; color: #FFC830; text-shadow: 1px 1px 1px #FA8103; }
      h1 { text-align: center; font-size: 4em; }
      h2 { font-size: 2.4em; }
      h3 { font-size: 2em; }
      h4 { font-size: 1.6em; }
      
      a { color: inherit; }
      
      pre {
        border: 3px dashed #333;
        padding: 15px; 
        background-color: #444;
        text-wrap: wrap;
        white-space: pre-wrap;
        white-space: -moz-pre-wrap;
        white-space: -pre-wrap;
        white-space: -o-pre-wrap;
        word-wrap: break-word;
      }
        
      code {
        padding: 2px;
        font-size: 0.7em;
        background-color: #444;
        color: #C5DBA9;
        font-family: 'Monaco',Courier,monospace !important;
      }
      
      code .keyword              { font-weight: bold; color: #E9C062; }
      code .string, code .regexp, code .number { color: #ffbb00 }
      code .class, code .special { color: white }
      code .comment              { color: #CCC }

    </style>

  </head>
  
  <body>
    <div id="container" style="position: relative">
      <a href="http://github.com/frank06/riak-js">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png" alt="Fork me on GitHub" />
      </a>
      
      <h1>riak-js</h1>
      <div>
        <h3>Javascript library for Riak</h3> 

        <ul> 
        <li>Sensible yet overridable defaults (init, per-request)</li> 
        <li>Operations: get, head, save, remove, walk, map/reduce</li> 
        <li>Available for node.js (v0.1.97+) and jQuery (browser) platforms; extensible to other implementations</li> 
        <li>Works on Riak 0.10+</li> 
        </ul> 


        <h3>Set up</h3> 

        <h4>node.js</h4> 

        <pre>
<code>// npm install riak-js  # @latest or @stable -- your pick
var db = require('riak-js').getClient()

// or cloning this repo
var db = require('/path/to/riak-js/lib').getClient()</code></pre> 

        <h4>jQuery (browser)</h4> 

        <pre>
<code>&lt;script type="text/javascript" src="riak.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="riak-jquery.js"&gt;&lt;/script&gt;

var db = new Riak();
</code></pre> 

        <h3>An example session</h3> 

        <h4>Get and save a document</h4> 

        <pre>
<code>db.get('albums', 4)(function(album, meta) {
  album.tracks = 12;
  db.save('albums', 4, album)(); // we use the provided default callbacks: log the result
});</code></pre> 

        <h4>Use the Map/Reduce API</h4> 

        <pre><code>db.map({name: 'Riak.mapValuesJson'}).run('albums')()</code></pre> 

        <p>Note: you can pass arrays of phases, too. Like</p> 

        <pre>
<code>db
  .link([{ bucket: a, tag: "_", keep: false }, { bucket: b, tag: "songs", keep: true }])
  .reduce({name: 'Riak.myReduce'})
  .run('albums')()</code></pre> 

        <h4>Save an image</h4> 

        <pre><code>fs.readFile("/path/to/your/image.jpg", 'binary', function (err, data) {
  if (err) throw err;
  db.save('test', 'image', data, { type: 'jpeg' })()
});</code></pre> 

        <p>Check out the tests for more.</p> 

        <h3>Defaults</h3> 

        <p>All operations take an <code>options</code> object as the last argument. These specified options will override the defaults, which are defined as:</p> 

        <pre><code>{
  clientId: 'riak-js', 
  method: 'GET',
  interface: 'riak',
  headers: {},
  debug: true,
  callback: function(response, meta) {
    if (response)
      Riak.prototype.log(meta.type == 'application/json' ? JSON.stringify(response) : response)
  }
}</code></pre>
        
        <p>During client instantiation, defaults are <code>localhost</code> for the host and <code>8098</code> for the port. If you pass-in the <code>defaults</code> as an argument, they will apply to the whole session instead of per-request:</p> 

        <pre><code>var db = new Riak.Client({ host: 'localhost', port: 8098, interface: 'bananas', debug: false });</code></pre> 

        <p>Note that you cannot change host or port on the instantiated client.</p> 

        <h3>Noteworthy points</h3> 

        <ul> 
        <li>All operations return a function that takes a <code>callback</code>. Therefore you <em>must</em> call it for something to happen: <code>db.get('bucket')()</code> (default callback), or <code>db.get('bucket', 'key')(mycallback)</code></li> 
        <li>This function is passed in two arguments, the <code>response</code> object and a <code>meta</code> object: <code>var mycallback = function(response, meta) {}</code></li> 
        <li>Headers are exposed through <code>meta.headers</code> and the status code through <code>meta.statusCode</code></li> 
        <li>All operations accept an <code>options</code> object as the last argument, which will be <em>mixed-in</em> as to override certain defaults</li> 
        <li>If no <code>Content-Type</code> header is provided, <code>application/json</code> will be assumed - which in turn will be serialized into JSON</li> 
        <li>Link-walking is done through the map/reduce interface</li> 
        <li>If no <code>language</code> is provided in any map/reduce phase, <code>language: javascript</code> is assumed</li> 
        <li><code>http.Client</code> queues all requests, so if you want to run requests in parallel you need to create one client instance for each request</li> 
        </ul> 

        <h3>Authors and contributors</h3> 

        <ul> 
        <li><a href="http://github.com/frank06">frank06</a></li> 
        <li><a href="http://github.com/siculars">siculars</a></li> 
        <li><a href="http://github.com/freshtonic">freshtonic</a></li> 
        <li><a href="http://github.com/botanicus">botanicus</a></li> 
        </ul>
        
      </div>
    </div>
    
    <script src="hijs.js" type="text/javascript" charset="utf-8"></script>
  </body>
  
</html>